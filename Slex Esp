if not game:IsLoaded() then game.Loaded:Wait() end

-- Services
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")

-- Settings
local settings = {
    Enabled = true,
    Box = true,
    Skeleton = true,
    Health = true,
    Names = true,
    Color = Color3.fromRGB(255, 80, 80)
}

local ESP = {}

-- ===== GUI =====
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "SlexProjectESP"

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 220, 0, 230)
frame.Position = UDim2.new(0.8, 0, 0.5, -115)
frame.BackgroundColor3 = Color3.fromRGB(35,35,35)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1,0,0,25)
title.BackgroundColor3 = Color3.fromRGB(55,55,55)
title.Text = "Slex Project"
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.GothamBold
title.TextSize = 13

local function Toggle(text, y, key)
    local btn = Instance.new("TextButton", frame)
    btn.Size = UDim2.new(1,-20,0,30)
    btn.Position = UDim2.new(0,10,0,y)
    btn.BackgroundColor3 = Color3.fromRGB(50,50,50)
    btn.BorderSizePixel = 0
    btn.Text = ""
    btn.AutoButtonColor = false

    local lbl = Instance.new("TextLabel", btn)
    lbl.Size = UDim2.new(1,-40,1,0)
    lbl.Position = UDim2.new(0,10,0,0)
    lbl.BackgroundTransparency = 1
    lbl.Text = text
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.Font = Enum.Font.Gotham
    lbl.TextSize = 13
    lbl.TextXAlignment = Left

    local mark = Instance.new("TextLabel", btn)
    mark.Size = UDim2.new(0,30,1,0)
    mark.Position = UDim2.new(1,-30,0,0)
    mark.BackgroundTransparency = 1
    mark.Font = Enum.Font.GothamBold
    mark.TextSize = 16

    local function refresh()
        mark.Text = settings[key] and "✓" or "○"
        mark.TextColor3 = settings[key] and Color3.fromRGB(0,255,0) or Color3.fromRGB(120,120,120)
    end

    refresh()
    btn.MouseButton1Click:Connect(function()
        settings[key] = not settings[key]
        refresh()
    end)
end

Toggle("Box ESP", 35, "Box")
Toggle("Skeleton ESP", 70, "Skeleton")
Toggle("Health ESP", 105, "Health")
Toggle("Name ESP", 140, "Names")

-- ===== SKELETON BONES =====
local BonesR15 = {
    {"Head","UpperTorso"},{"UpperTorso","LowerTorso"},
    {"UpperTorso","LeftUpperArm"},{"LeftUpperArm","LeftLowerArm"},{"LeftLowerArm","LeftHand"},
    {"UpperTorso","RightUpperArm"},{"RightUpperArm","RightLowerArm"},{"RightLowerArm","RightHand"},
    {"LowerTorso","LeftUpperLeg"},{"LeftUpperLeg","LeftLowerLeg"},{"LeftLowerLeg","LeftFoot"},
    {"LowerTorso","RightUpperLeg"},{"RightUpperLeg","RightLowerLeg"},{"RightLowerLeg","RightFoot"}
}

local BonesR6 = {
    {"Head","Torso"},
    {"Torso","Left Arm"},{"Torso","Right Arm"},
    {"Torso","Left Leg"},{"Torso","Right Leg"}
}

-- ===== ESP CREATE =====
local function CreateESP(plr)
    if ESP[plr] then return end

    local data = {
        Box = Drawing.new("Square"),
        HealthBar = Drawing.new("Square"),
        HealthBG = Drawing.new("Square"),
        Name = Drawing.new("Text"),
        Skeleton = {}
    }

    data.Box.Thickness = 1
    data.Box.Filled = false

    data.HealthBG.Filled = true
    data.HealthBG.Color = Color3.fromRGB(20,20,20)

    data.HealthBar.Filled = true

    data.Name.Center = true
    data.Name.Outline = true
    data.Name.Size = 16
    data.Name.Font = 2

    ESP[plr] = data

    RunService.RenderStepped:Connect(function()
        local char = plr.Character
        if not char or not settings.Enabled then
            for _,v in pairs(data) do
                if typeof(v) == "table" then
                    for _,l in ipairs(v) do l.Visible = false end
                elseif v.Visible ~= nil then
                    v.Visible = false
                end
            end
            return
        end

        local hrp = char:FindFirstChild("HumanoidRootPart")
        local hum = char:FindFirstChildOfClass("Humanoid")
        if not hrp or not hum then return end

        local cf, size = char:GetBoundingBox()
        local corners = {
            cf * Vector3.new( size.X,  size.Y, 0) / 2,
            cf * Vector3.new(-size.X,  size.Y, 0) / 2,
            cf * Vector3.new( size.X, -size.Y, 0) / 2,
            cf * Vector3.new(-size.X, -size.Y, 0) / 2
        }

        local minX, minY = math.huge, math.huge
        local maxX, maxY = -math.huge, -math.huge
        local onScreen = false

        for _,p in ipairs(corners) do
            local v, vis = Camera:WorldToViewportPoint(p)
            if vis then
                onScreen = true
                minX, minY = math.min(minX,v.X), math.min(minY,v.Y)
                maxX, maxY = math.max(maxX,v.X), math.max(maxY,v.Y)
            end
        end

        if not onScreen then return end

        local w, h = maxX-minX, maxY-minY
        local color = settings.Color

        -- BOX
        data.Box.Visible = settings.Box
        data.Box.Size = Vector2.new(w,h)
        data.Box.Position = Vector2.new(minX,minY)
        data.Box.Color = color

        -- NAME
        data.Name.Visible = settings.Names
        data.Name.Text = plr.Name
        data.Name.Position = Vector2.new(minX + w/2, minY - 15)
        data.Name.Color = color

        -- HEALTH
        local hp = math.clamp(hum.Health / hum.MaxHealth, 0, 1)
        data.HealthBG.Visible = settings.Health
        data.HealthBar.Visible = settings.Health

        data.HealthBG.Size = Vector2.new(4,h)
        data.HealthBG.Position = Vector2.new(minX-6,minY)

        data.HealthBar.Size = Vector2.new(4,h*hp)
        data.HealthBar.Position = Vector2.new(minX-6,minY + (h - h*hp))
        data.HealthBar.Color = Color3.fromRGB(255*(1-hp),255*hp,0)

        -- SKELETON
        local bones = char:FindFirstChild("UpperTorso") and BonesR15 or BonesR6
        for i,b in ipairs(bones) do
            data.Skeleton[i] = data.Skeleton[i] or Drawing.new("Line")
            local p1,p2 = char:FindFirstChild(b[1]), char:FindFirstChild(b[2])
            if settings.Skeleton and p1 and p2 then
                local a,v1 = Camera:WorldToViewportPoint(p1.Position)
                local c,v2 = Camera:WorldToViewportPoint(p2.Position)
                data.Skele
